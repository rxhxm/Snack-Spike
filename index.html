<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Understanding Glucose Response</title>
    <link rel="icon" type="image/png" href="gleco.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f5f7;
            color: #333;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        
        #canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: rgba(245, 245, 247, 0.9); /* Darker container background */
            border-radius: 0; /* Remove rounded corners */
            box-shadow: 0 15px 50px rgba(31, 38, 135, 0.3);
            backdrop-filter: blur(4px);
            padding: 30px 20px; /* Reduced padding */
            margin: 0; /* Remove all margins */
            width: 100%; /* Full width */
            max-width: none; /* Remove max-width limitation */
            min-height: 100vh; /* Make it at least full viewport height */
            position: absolute; /* Position absolute to cover the entire page */
            top: 0;
            left: 0;
            right: 0;
        }
        
        .explainer-section {
            background: rgba(255, 255, 255, 0.8);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            margin-bottom: 30px;
            width: 100%;
            max-width: 800px;
            transition: transform 0.3s;
        }
        
        .explainer-section:hover {
            transform: translateY(-5px);
        }
        
        .section-title {
            color: #0066CC;
            font-size: 24px;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .graph-container {
            position: relative;
            margin: 30px 0;
            overflow: hidden;
        }
        
        .annotation {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            position: absolute;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 14px;
            max-width: 200px;
        }
        
        .healthy-range {
            background: rgba(150, 220, 150, 0.2);
            border: 1px dashed #4CAF50;
            position: absolute;
            top: 120px;
            height: 60px;
            width: 100%;
            z-index: 1;
        }
        
        .meal-marker {
            position: absolute;
            top: 0;
            width: 2px;
            height: 300px;
            background: rgba(255, 0, 0, 0.5);
            z-index: 2;
        }
        
        .meal-label {
            position: absolute;
            background: #fff;
            border: 1px solid #ff6b6b;
            color: #ff6b6b;
            padding: 5px 10px;
            border-radius: 15px;
            transform: rotate(-45deg);
            transform-origin: left top;
            font-size: 12px;
            font-weight: bold;
            z-index: 3;
        }
        
        .info-box {
            background: #f0f7ff;
            border-left: 4px solid #0066CC;
            padding: 15px;
            margin: 20px 0;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .comparison-table th, .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .comparison-table th {
            background-color: #f5f5f7;
        }
        
        .comparison-table tr:hover {
            background-color: #f9f9f9;
        }
        
        .food-impact {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
        }
        
        .food-card {
            background: white;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            width: 30%;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .food-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .impact-label {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .impact-high {
            background: #ffebee;
            color: #d32f2f;
        }
        
        .impact-medium {
            background: #fff8e1;
            color: #ff8f00;
        }
        
        .impact-low {
            background: #e8f5e9;
            color: #388e3c;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 20px;
        }
        
        .nav-button {
            background: #0066CC;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .nav-button:hover {
            background: #0055aa;
        }
        
        .nav-button.disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        
        /* Game-related styles from the second file */
        .clock-container {
            position: relative;
            width: 600px;
            height: 600px;
            margin: 40px 0;
            display: none; /* Hidden by default, shown when game starts */
            background: linear-gradient(145deg, #f5f5f7, #ffffff);
            border-radius: 50%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15), inset 0 -5px 15px rgba(0,0,0,0.05);
            padding: 20px;
        }
        
        /* Clock face styling */
        .clock-face {
            fill: white;
            stroke: #e0e0e5;
            stroke-width: 1;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
        }
        
        /* Clock hour markers */
        .hour-marker {
            stroke: #555;
            stroke-width: 2;
        }
        
        /* Clock minute markers */
        .minute-marker {
            stroke: #aaa;
            stroke-width: 1;
        }
        
        /* Time labels styling */
        .time-label {
            font-size: 14px;
            font-weight: 500;
            fill: #444;
            text-anchor: middle;
        }
        
        /* Glucose level indicator styling */
        .glucose-level-circle {
            fill: none;
            stroke-width: 1;
            stroke-dasharray: 3,3;
        }
        
        /* Glucose level label styling */
        .glucose-label {
            font-size: 12px;
            fill: #888;
            text-anchor: start;
        }
        
        .prediction-controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            width: 100%;
            max-width: 600px;
            display: none; /* Hidden by default, shown when game starts */
        }
        
        /* Food drag and drop styles */
        .food-selection {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .food-option {
            padding: 10px 15px;
            background: #e9f5ff;
            border: 1px solid #b8daff;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }
        
        .food-option:hover {
            background: #d0e8ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .food-option.selected {
            background: #2b87ff;
            color: white;
        }
        
        .food-option.draggable {
            cursor: grab;
        }
        
        .food-option.dragging {
            cursor: grabbing;
            opacity: 0.8;
            position: absolute;
            z-index: 1000;
            pointer-events: none;
        }

        /* Time indicator */
        .time-indicator {
            position: absolute;
            z-index: 10;
            pointer-events: none;
        }
        
        .time-indicator-line {
            stroke: #0066CC;
            stroke-width: 2;
            stroke-dasharray: 5,3;
        }
        
        .time-indicator-label {
            background: rgba(0, 102, 204, 0.9);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            position: absolute;
            transform: translate(-50%, -100%);
            margin-top: -10px;
        }
        
        /* Drop target indicator */
        .drop-target {
            fill: rgba(0, 102, 204, 0.2);
            stroke: #0066CC;
            stroke-width: 2;
            stroke-dasharray: 5,3;
            display: none;
        }
        
        /* Placed food marker styles */
        .placed-food {
            position: absolute;
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 5;
            transform: translate(-50%, -50%);
            font-size: 24px;
            width: 48px;
            height: 48px;
            pointer-events: none;
        }
        
        /* Patient profile card */
        .patient-profile {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 0 auto 30px;
            max-width: 800px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .patient-profile h3 {
            color: #0066CC;
            margin-top: 0;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .vital-stats {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .stat-item {
            background: #f5f7fa;
            padding: 10px 15px;
            border-radius: 8px;
            flex: 1;
            min-width: 100px;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }
        
        /* Alert box for glucose event */
        .glucose-alert {
            background: #fff8e1;
            border-left: 4px solid #ffab00;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .glucose-alert h4 {
            color: #f57c00;
            margin-top: 0;
            margin-bottom: 10px;
        }
        
        .results-panel {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-top: 30px;
            width: 100%;
            max-width: 600px;
            display: none; /* Hidden by default, shown when results are available */
        }
        
        .score {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .accuracy-meter {
            height: 30px;
            background: #f0f0f0;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .accuracy-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4646 0%, #ffaa00 50%, #00cc66 100%);
            width: 75%;
        }
        
        .feedback {
            line-height: 1.6;
        }
        
        /* Added for navigation between sections */
        #explainer-content {
            display: block;
        }
        
        #game-content {
            display: none;
        }
        
        @media (max-width: 768px) {
            .food-impact {
                flex-direction: column;
            }
            
            .food-card {
                width: 100%;
                margin-bottom: 15px;
            }
            
            .clock-container {
                width: 100%;
                height: auto;
            }
        }
        
        /* Add styles for the prediction notification */
        .prediction-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 102, 204, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
            font-weight: bold;
            pointer-events: none;
            transition: opacity 0.5s;
        }
        
        /* Ensure tooltip displays properly */
        #clock-tooltip {
            position: absolute;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            pointer-events: none;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            display: none;
        }
        
        /* Center all content better */
        .container {
            align-items: center;
            justify-content: center;
            width: 100%;
        }
        
        /* Make sure game content is centered and wider */
        #game-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 1000px; /* Increased from 800px */
        }
        
        /* Ensure prediction controls are centered and wider */
        .prediction-controls {
            margin: 0 auto !important;
            text-align: center;
            width: 100%;
            max-width: 800px; /* Increased from default */
        }
        
        /* Make intro paragraph wider */
        #game-content > p {
            max-width: 900px !important; /* Increased width */
            margin: 0 auto 20px auto;
        }
        
        /* Make instructions wider */
        .prediction-instructions {
            max-width: 800px !important; /* Increased from 600px */
        }
        
        /* Improve clock container centering */
        .clock-container {
            display: flex !important;
            justify-content: center !important;
            align-items: center !important;
            width: 100%;
        }
        
        /* Ensure results panel is centered and wider */
        .results-panel {
            margin: 20px auto !important;
            text-align: left;
            max-width: 800px !important; /* Increased from default */
        }
        
        /* Improve button centering in results panel */
        .results-panel .submit-btn {
            display: block;
            margin: 20px auto;
        }
        
        /* Make food selection wider */
        .food-selection {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
            width: 100%;
        }
        
        /* Give more space to time selector */
        .time-selector {
            margin: 0 auto 20px;
            width: 100%;
            max-width: 500px;
        }
        
        /* Add the following CSS rule for the submit button */
        .submit-btn {
            display: none;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
            transition: background-color 0.3s;
        }
        
        .submit-btn:hover {
            background-color: #45a049;
        }
        
        /* Submit button styling */
        .submit-analysis-btn {
            padding: 12px 24px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 20px auto;
            display: none; /* Hidden by default, shown after food placement */
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .submit-analysis-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }
        
        /* Game header styling */
        .game-header {
            max-width: 800px;
            margin: 0 auto 30px;
            text-align: center;
        }
        
        .game-header h2 {
            color: #0066CC;
            margin-bottom: 15px;
        }
        
        .challenge-box {
            background: #f0f8ff;
            border-left: 5px solid #0066CC;
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 0 8px 8px 0;
            text-align: left;
        }
        
        /* Add CSS for the fun facts feature */
        .fun-fact-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            cursor: pointer;
            z-index: 1000;
            transition: transform 0.3s, box-shadow 0.3s;
            animation: vibrate 3s infinite;
            transform-origin: center center;
        }
        
        .fun-fact-button:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            animation-play-state: paused;
        }
        
        @keyframes vibrate {
            0%, 100% { transform: scale(1); }
            90% { transform: scale(1); }
            92% { transform: scale(1.1) rotate(5deg); }
            94% { transform: scale(1.15) rotate(-5deg); }
            96% { transform: scale(1.2) rotate(5deg); }
            98% { transform: scale(1.15) rotate(-5deg); }
        }
        
        .fun-fact-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 500px;
            width: 90%;
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 1001;
            display: none;
            opacity: 0;
            transition: opacity 0.3s;
            animation: pop-in 0.5s forwards;
        }
        
        @keyframes pop-in {
            0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
            70% { transform: translate(-50%, -50%) scale(1.05); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        .fun-fact-modal.show {
            display: block;
            opacity: 1;
        }
        
        .fun-fact-modal h3 {
            color: #FF5722;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 24px;
            display: flex;
            align-items: center;
        }
        
        .fun-fact-modal h3 span {
            margin-right: 10px;
        }
        
        .fun-fact-content {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 25px;
        }
        
        .fun-fact-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }
        
        .fun-fact-button-next {
            padding: 8px 16px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        .fun-fact-button-next:hover {
            background: #45a049;
        }
        
        .fun-fact-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 22px;
            color: #999;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .fun-fact-close:hover {
            color: #333;
        }
        
        .fun-fact-counter {
            font-size: 14px;
            color: #777;
        }
        
        .fun-fact-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            display: none;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .fun-fact-overlay.show {
            display: block;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div id="canvas"></div>
    

    <div class="container">
        <h1>Snack & Spike: Understanding Your Glucose Response</h1>
        
        <!-- Navigation tabs for switching between explainer and game -->
        <div style="display: flex; width: 100%; max-width: 800px; margin-bottom: 20px;">
            <button id="explainer-tab" class="nav-button" style="flex: 1; margin-right: 10px; background: #0066CC;">
                Learn About Glucose
            </button>
            <button id="game-tab" class="nav-button" style="flex: 1; background: #cccccc;">
                Prediction Game
            </button>
        </div>
        
        <div id="explainer-content">
            <div class="explainer-section">
                <h2 class="section-title">What is Blood Glucose?</h2>
                
                <p>Blood glucose (blood sugar) is the main sugar found in your bloodstream and your body's primary energy source. It comes from the food you eat, especially carbohydrates like sugars and starches.</p>
                
                <p>Your body carefully regulates blood glucose levels to maintain them within a healthy range:</p>
                
                <div class="info-box">
                    <strong>Normal Blood Glucose Ranges:</strong>
                    <ul>
                        <li>Fasting (before meals): 70-99 mg/dL</li>
                        <li>After meals: Less than 140 mg/dL</li>
                        <li>Random checks: Less than 140 mg/dL</li>
                    </ul>
                </div>
                
                <p>When glucose levels rise too high or fall too low, it can affect how you feel and potentially impact your health over time.</p>
            </div>
            
            <div class="explainer-section">
                <h2 class="section-title">Understanding Glucose Spikes</h2>
                
                <p>When you eat, especially foods containing carbohydrates, your blood glucose levels rise. This is called a "glucose spike" or "postprandial spike" (after meal spike).</p>
                
                <div class="graph-container" style="height: 350px;">
                    <!-- Sample glucose graph showing daily pattern with meals -->
                    <svg width="700" height="300" viewBox="0 0 700 300">
                        <!-- Background grid -->
                        <line x1="0" y1="60" x2="700" y2="60" stroke="#eee" stroke-width="1"/>
                        <line x1="0" y1="120" x2="700" y2="120" stroke="#eee" stroke-width="1"/>
                        <line x1="0" y1="180" x2="700" y2="180" stroke="#eee" stroke-width="1"/>
                        <line x1="0" y1="240" x2="700" y2="240" stroke="#eee" stroke-width="1"/>
                        
                        <!-- Time markers -->
                        <line x1="100" y1="240" x2="100" y2="245" stroke="#888" stroke-width="1"/>
                        <text x="100" y="260" text-anchor="middle" font-size="12">8:00</text>
                        <line x1="200" y1="240" x2="200" y2="245" stroke="#888" stroke-width="1"/>
                        <text x="200" y="260" text-anchor="middle" font-size="12">10:00</text>
                        <line x1="300" y1="240" x2="300" y2="245" stroke="#888" stroke-width="1"/>
                        <text x="300" y="260" text-anchor="middle" font-size="12">12:00</text>
                        <line x1="400" y1="240" x2="400" y2="245" stroke="#888" stroke-width="1"/>
                        <text x="400" y="260" text-anchor="middle" font-size="12">14:00</text>
                        <line x1="500" y1="240" x2="500" y2="245" stroke="#888" stroke-width="1"/>
                        <text x="500" y="260" text-anchor="middle" font-size="12">16:00</text>
                        <line x1="600" y1="240" x2="600" y2="245" stroke="#888" stroke-width="1"/>
                        <text x="600" y="260" text-anchor="middle" font-size="12">18:00</text>
                        
                        <!-- Glucose level markers -->
                        <text x="30" y="240" text-anchor="end" font-size="12">70</text>
                        <text x="30" y="180" text-anchor="end" font-size="12">100</text>
                        <text x="30" y="120" text-anchor="end" font-size="12">130</text>
                        <text x="30" y="60" text-anchor="end" font-size="12">160</text>
                        
                        <!-- Healthy range -->
                        <rect x="40" y="180" width="660" height="60" fill="rgba(150, 220, 150, 0.2)" stroke="#4CAF50" stroke-width="1" stroke-dasharray="5,5"/>
                        <text x="50" y="200" font-size="12" fill="#388e3c">Healthy Range</text>
                        
                        <!-- Meal markers -->
                        <line x1="100" y1="40" x2="100" y2="280" stroke="rgba(255, 0, 0, 0.5)" stroke-width="2"/>
                        <text x="110" y="50" font-size="12" fill="#d32f2f">Breakfast</text>
                        
                        <line x1="300" y1="40" x2="300" y2="280" stroke="rgba(255, 0, 0, 0.5)" stroke-width="2"/>
                        <text x="310" y="50" font-size="12" fill="#d32f2f">Lunch</text>
                        
                        <line x1="500" y1="40" x2="500" y2="280" stroke="rgba(255, 0, 0, 0.5)" stroke-width="2"/>
                        <text x="510" y="50" font-size="12" fill="#d32f2f">Dinner</text>
                        
                        <!-- Glucose curve -->
                        <path d="M40,210 C70,205 90,208 100,210 C110,210 120,160 140,120 C160,80 180,100 200,140 C220,180 270,210 300,210 C330,210 340,100 360,80 C380,70 400,120 420,160 C440,200 480,210 500,210 C520,210 530,110 550,90 C570,80 590,120 620,170 C650,210 670,215 700,220" 
                              fill="none" stroke="#0066CC" stroke-width="3"/>
                        
                        <!-- Annotations -->
                        <rect x="140" y="80" width="150" height="40" rx="5" fill="rgba(255,255,255,0.9)" stroke="#ddd"/>
                        <text x="150" y="100" font-size="12" fill="#333">High carb breakfast causes</text>
                        <text x="150" y="115" font-size="12" fill="#333">steep glucose spike</text>
                        <line x1="140" y1="100" x2="120" y2="120" stroke="#888" stroke-width="1" stroke-dasharray="2,2"/>
                        
                        <rect x="360" y="50" width="150" height="40" rx="5" fill="rgba(255,255,255,0.9)" stroke="#ddd"/>
                        <text x="370" y="70" font-size="12" fill="#333">Lunch spike with more</text>
                        <text x="370" y="85" font-size="12" fill="#333">gradual return to baseline</text>
                        <line x1="360" y1="70" x2="340" y2="85" stroke="#888" stroke-width="1" stroke-dasharray="2,2"/>
                        
                        <rect x="550" y="140" width="120" height="40" rx="5" fill="rgba(255,255,255,0.9)" stroke="#ddd"/>
                        <text x="560" y="160" font-size="12" fill="#333">Dinner with protein</text>
                        <text x="560" y="175" font-size="12" fill="#333">moderate spike</text>
                        <line x1="550" y1="160" x2="520" y2="140" stroke="#888" stroke-width="1" stroke-dasharray="2,2"/>
                    </svg>
                    
                    <div class="annotation" style="top: 10px; right: 20px;">
                        <strong>Glucose levels throughout a day</strong><br>
                        Notice how each meal causes a different spike pattern based on what was eaten.
                    </div>
                </div>
                
                <p>The size and duration of glucose spikes depend on several factors:</p>
                
                <div class="info-box">
                    <strong>What affects your glucose spikes:</strong>
                    <ul>
                        <li><strong>Carbohydrate content:</strong> Higher carbs typically cause larger spikes</li>
                        <li><strong>Food composition:</strong> Fiber, protein, and fat can slow digestion and moderate spikes</li>
                        <li><strong>Time of day:</strong> Many people experience larger spikes in the morning</li>
                        <li><strong>Individual factors:</strong> Metabolism, insulin sensitivity, and activity level</li>
                    </ul>
                </div>
                
                <p>Frequent, large glucose spikes followed by crashes can contribute to fatigue, hunger, cravings, and over time, may increase risk for conditions like insulin resistance and type 2 diabetes.</p>
            </div>
            
            <div class="explainer-section">
                <h2 class="section-title">Different Foods, Different Responses</h2>
                
                <p>Not all foods affect your blood glucose the same way. Here's how different foods typically impact glucose levels:</p>
                
                <div class="food-category-container" style="display: flex; justify-content: space-between; margin: 20px 0; flex-wrap: wrap;">
                    <div class="food-category high-glycemic" onclick="selectFoodCategory('high')" style="flex: 1; min-width: 200px; margin: 5px; padding: 20px; border-radius: 10px; border: 2px solid #f0f0f0; cursor: pointer; text-align: center; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                        <div style="font-size: 40px; margin-bottom: 10px;">🍚</div>
                        <h3>High Glycemic Foods</h3>
                        <p>White bread, rice, potatoes, sugary drinks</p>
                        <div style="background: #ffebee; color: #e53935; padding: 5px 15px; border-radius: 20px; display: inline-block; margin-top: 10px;">Large Spike</div>
                    </div>
                    
                    <div class="food-category medium-glycemic" onclick="selectFoodCategory('medium')" style="flex: 1; min-width: 200px; margin: 5px; padding: 20px; border-radius: 10px; border: 2px solid #f0f0f0; cursor: pointer; text-align: center; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                        <div style="font-size: 40px; margin-bottom: 10px;">🍎</div>
                        <h3>Medium Glycemic Foods</h3>
                        <p>Whole fruit, oatmeal, sweet potatoes</p>
                        <div style="background: #fff8e1; color: #ff9800; padding: 5px 15px; border-radius: 20px; display: inline-block; margin-top: 10px;">Moderate Spike</div>
                    </div>
                    
                    <div class="food-category low-glycemic" onclick="selectFoodCategory('low')" style="flex: 1; min-width: 200px; margin: 5px; padding: 20px; border-radius: 10px; border: 2px solid #f0f0f0; cursor: pointer; text-align: center; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                        <div style="font-size: 40px; margin-bottom: 10px;">🥦</div>
                        <h3>Low Glycemic Foods</h3>
                        <p>Non-starchy vegetables, beans, nuts</p>
                        <div style="background: #e8f5e9; color: #4caf50; padding: 5px 15px; border-radius: 20px; display: inline-block; margin-top: 10px;">Minimal Spike</div>
                    </div>
                </div>
                
                <div class="view-options" style="text-align: center; margin: 20px 0;">
                    <button onclick="selectFoodCategory('all')" id="view-all-btn" class="food-toggle-btn" style="background: #0066CC; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin: 0 5px;">View All</button>
                    <button onclick="selectFoodCategory('high')" id="high-btn" class="food-toggle-btn" style="background: #f5f5f7; color: #333; border: 1px solid #ddd; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin: 0 5px;">White Rice</button>
                    <button onclick="selectFoodCategory('medium')" id="medium-btn" class="food-toggle-btn" style="background: #f5f5f7; color: #333; border: 1px solid #ddd; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin: 0 5px;">Apple</button>
                    <button onclick="selectFoodCategory('low')" id="low-btn" class="food-toggle-btn" style="background: #f5f5f7; color: #333; border: 1px solid #ddd; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin: 0 5px;">Broccoli</button>
                </div>
                
                <div class="graph-container" style="position: relative; height: 400px; margin: 30px 0; overflow: hidden; border: 1px solid #eee; background: white; border-radius: 8px;">
                    <svg id="food-comparison-graph" width="100%" height="100%" viewBox="0 0 800 400" preserveAspectRatio="xMidYMid meet">
                        <!-- X and Y axis -->
                        <line x1="80" y1="320" x2="750" y2="320" stroke="#333" stroke-width="2"/>
                        <line x1="80" y1="50" x2="80" y2="320" stroke="#333" stroke-width="2"/>
                        
                        <!-- Horizontal guidelines -->
                        <line x1="80" y1="80" x2="750" y2="80" stroke="#eee" stroke-width="1"/>
                        <line x1="80" y1="160" x2="750" y2="160" stroke="#eee" stroke-width="1"/>
                        <line x1="80" y1="240" x2="750" y2="240" stroke="#eee" stroke-width="1"/>
                        <line x1="80" y1="320" x2="750" y2="320" stroke="#eee" stroke-width="1"/>
                        
                        <!-- Vertical guidelines/time markers -->
                        <line x1="190" y1="320" x2="190" y2="325" stroke="#888" stroke-width="1"/>
                        <text x="190" y="345" text-anchor="middle" font-size="14">30 min</text>
                        <line x1="300" y1="320" x2="300" y2="325" stroke="#888" stroke-width="1"/>
                        <text x="300" y="345" text-anchor="middle" font-size="14">60 min</text>
                        <line x1="410" y1="320" x2="410" y2="325" stroke="#888" stroke-width="1"/>
                        <text x="410" y="345" text-anchor="middle" font-size="14">90 min</text>
                        <line x1="520" y1="320" x2="520" y2="325" stroke="#888" stroke-width="1"/>
                        <text x="520" y="345" text-anchor="middle" font-size="14">120 min</text>
                        <line x1="630" y1="320" x2="630" y2="325" stroke="#888" stroke-width="1"/>
                        <text x="630" y="345" text-anchor="middle" font-size="14">150 min</text>
                        <line x1="80" y1="320" x2="80" y2="325" stroke="#888" stroke-width="1"/>
                        <text x="80" y="345" text-anchor="middle" font-size="14">0 min</text>
                        
                        <!-- Glucose level markers -->
                        <text x="70" y="320" text-anchor="end" font-size="14">70</text>
                        <text x="70" y="240" text-anchor="end" font-size="14">100</text>
                        <text x="70" y="160" text-anchor="end" font-size="14">130</text>
                        <text x="70" y="80" text-anchor="end" font-size="14">160</text>
                        
                        <!-- Food consumed label -->
                        <text x="400" y="35" text-anchor="middle" font-size="16" font-weight="bold">Food Consumed</text>
                        <line x1="140" y1="50" x2="140" y2="320" stroke="#ccc" stroke-width="1" stroke-dasharray="5,5"/>
                        
                        <!-- Glucose curves for different foods -->
                        <!-- White Rice (high glycemic) - red -->
                        <path id="high-glycemic-curve" d="M80,290 C120,290 150,200 190,120 C230,60 270,80 300,100 C340,150 380,220 410,260 C440,290 520,290 630,290" 
                              fill="none" stroke="#e53935" stroke-width="3"/>
                              
                        <!-- Apple (medium glycemic) - orange -->
                        <path id="medium-glycemic-curve" d="M80,290 C120,290 150,240 190,180 C230,160 270,170 300,190 C340,220 380,260 410,270 C440,280 520,290 630,290" 
                              fill="none" stroke="#ff9800" stroke-width="3"/>
                              
                        <!-- Broccoli (low glycemic) - green -->
                        <path id="low-glycemic-curve" d="M80,290 C120,290 150,275 190,260 C230,255 270,260 300,270 C340,280 380,285 410,290 C440,290 520,290 630,290" 
                              fill="none" stroke="#4caf50" stroke-width="3"/>
                              
                        <!-- Annotations - these will be shown/hidden based on selection -->
                        <!-- White Rice annotation -->
                        <g id="high-glycemic-annotation">
                            <rect x="360" y="60" width="200" height="50" rx="5" fill="white" stroke="#ddd" stroke-width="1"/>
                            <text x="370" y="85" font-size="14" fill="#e53935">White rice causes rapid</text>
                            <text x="370" y="105" font-size="14" fill="#e53935">high glucose spike</text>
                            <line x1="300" y1="100" x2="360" y2="85" stroke="#e53935" stroke-width="1" stroke-dasharray="3,3"/>
                        </g>
                        
                        <!-- Apple annotation -->
                        <g id="medium-glycemic-annotation">
                            <rect x="450" y="160" width="220" height="50" rx="5" fill="white" stroke="#ddd" stroke-width="1"/>
                            <text x="460" y="185" font-size="14" fill="#ff9800">Apple causes moderate spike</text>
                            <text x="460" y="205" font-size="14" fill="#ff9800">due to fiber content</text>
                            <line x1="350" y1="185" x2="450" y2="185" stroke="#ff9800" stroke-width="1" stroke-dasharray="3,3"/>
                        </g>
                        
                        <!-- Legend -->
                        <g id="legend" class="legend">
                            <text x="700" y="100" text-anchor="end" font-size="14" fill="#e53935">White Rice</text>
                            <line x1="660" y1="96" x2="680" y2="96" stroke="#e53935" stroke-width="3"/>
                            
                            <text x="700" y="125" text-anchor="end" font-size="14" fill="#ff9800">Apple</text>
                            <line x1="660" y1="121" x2="680" y2="121" stroke="#ff9800" stroke-width="3"/>
                            
                            <text x="700" y="150" text-anchor="end" font-size="14" fill="#4caf50">Broccoli</text>
                            <line x1="660" y1="146" x2="680" y2="146" stroke="#4caf50" stroke-width="3"/>
                        </g>
                        
                        <!-- Tooltip line - initially hidden -->
                        <line id="food-tooltip-line" x1="0" y1="50" x2="0" y2="320" stroke="#0066CC" stroke-width="2" style="display: none;"/>
                        
                        <!-- Tooltip glucose points - initially hidden -->
                        <circle id="high-glucose-point" cx="0" cy="0" r="5" fill="white" stroke="#e53935" stroke-width="2" style="display: none;"/>
                        <circle id="medium-glucose-point" cx="0" cy="0" r="5" fill="white" stroke="#ff9800" stroke-width="2" style="display: none;"/>
                        <circle id="low-glucose-point" cx="0" cy="0" r="5" fill="white" stroke="#4caf50" stroke-width="2" style="display: none;"/>
                    </svg>
                    
                    <!-- Tooltip container -->
                    <div id="food-glucose-tooltip" style="position: absolute; display: none; background: rgba(0,0,0,0.7); color: white; padding: 5px 10px; border-radius: 4px; font-size: 14px; pointer-events: none; z-index: 100;"></div>
                </div>
                
                <p>Understanding how different foods affect your glucose can help you make informed choices for better health and energy levels throughout the day.</p>
            </div>
            
            <div class="explainer-section">
                <h2 class="section-title">Why Monitor Glucose Patterns?</h2>
                
                <p>Understanding your glucose patterns can help you:</p>
                
                <ul>
                    <li><strong>Identify trigger foods</strong> that cause larger spikes than expected</li>
                    <li><strong>Optimize meal timing</strong> for better energy throughout the day</li>
                    <li><strong>Discover personal responses</strong> that may differ from typical patterns</li>
                    <li><strong>Make informed food choices</strong> based on their impact on your body</li>
                    <li><strong>Reduce energy crashes</strong> that can affect mood and productivity</li>
                </ul>
                
                <div class="info-box">
                    <p><strong>Did you know?</strong> Glucose responses can vary significantly between individuals, even when eating identical foods. This is due to differences in metabolism, gut microbiome, and other personal factors.</p>
                </div>
                
                <p>Ready to test your understanding? Click the "Start Prediction Game" button below to see if you can predict how different foods will affect glucose levels!</p>
                
                <div class="nav-buttons">
                    <button id="start-game-btn" class="nav-button">Start Prediction Game</button>
                </div>
            </div>
        </div>
        
        <!-- Game content from the second file -->
        <div id="game-content">
            <!-- Move patient profile and challenge description above the clock -->
            <div class="patient-profile" style="margin: 0 auto 30px;">
                <h3>Patient Profile: Sarah Johnson</h3>
                <div class="vital-stats">
                    <div class="stat-item">
                        <div class="stat-label">Age</div>
                        <div class="stat-value">34</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">BMI</div>
                        <div class="stat-value">24.5</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">A1C</div>
                        <div class="stat-value">5.6%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Fasting Glucose</div>
                        <div class="stat-value">95 mg/dL</div>
                    </div>
                </div>
                
                <div class="glucose-alert">
                    <h4>Glucose Event Detected</h4>
                    <p>Sarah experienced a <strong>glucose spike of 152 mg/dL at 2:00 PM</strong> today. She reported feeling fatigued, mildly thirsty, and had difficulty concentrating around this time.</p>
                    <p>She's using continuous glucose monitoring to understand how different foods affect her levels, but doesn't remember exactly when she ate before this spike occurred.</p>
                </div>
                
                <div class="challenge-box">
                    <h4 style="margin-top: 0;">Your Challenge</h4>
                    <p>Look at Sarah's glucose spike at 2:00 PM. When do you think she ate something that caused this response?</p>
                    <p><strong>Instructions:</strong> Drag a food from below and drop it on the clock to indicate when you think Sarah ate it.</p>
                </div>
                

                            <!-- Food options moved above the clock -->
            <div class="food-selection" style="margin: 0 auto 30px; max-width: 800px;">
                <div class="food-option draggable" data-food="apple" data-impact="medium" data-timing="30-45">🍎 Apple</div>
                <div class="food-option draggable" data-food="rice" data-impact="high" data-timing="45-60">🍚 White Rice</div>
                <div class="food-option draggable" data-food="chicken" data-impact="low" data-timing="60-90">🍗 Chicken</div>
                <div class="food-option draggable" data-food="ice-cream" data-impact="high" data-timing="30-45">🍦 Ice Cream</div>
                <div class="food-option draggable" data-food="salad" data-impact="low" data-timing="minimal">🥗 Salad</div>
                <div class="food-option draggable" data-food="burger" data-impact="high" data-timing="60-90">🍔 Burger</div>
                <div class="food-option draggable" data-food="croissant" data-impact="high" data-timing="30-45">🥐 Croissant</div>
            </div>
            
                            <!-- Explanation of timing moved to after the submit button -->
            <div style="background: #fff; padding: 15px; border-radius: 8px; max-width: 800px; margin: 20px auto; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h4 style="margin-top: 0; color: #0066CC;">Food Timing & Glucose Response</h4>
                <ul style="margin-bottom: 0;">
                    <li><strong>Fast-acting carbs</strong> (juice, white bread): Spike in 15-30 minutes</li>
                    <li><strong>Mixed meals</strong> (sandwich, rice): Spike in 30-60 minutes</li>
                    <li><strong>High-fat meals</strong> (burgers, pizza): Delayed spike, 1-2 hours</li>
                </ul>
            </div>
            </div>
            

            
            <div class="clock-container" style="margin: 0 auto; display: flex; justify-content: center;">
                <svg id="glucose-clock" width="600" height="600" viewBox="0 0 600 600">
                    <!-- Clock face background -->
                    <circle cx="300" cy="300" r="280" fill="white" class="clock-face"/>
                    
                    <!-- Outer bezel -->
                    <circle cx="300" cy="300" r="270" fill="none" stroke="#e0e0e5" stroke-width="2"/>
                    
                    <!-- Glucose zones shading -->
                    <circle cx="300" cy="300" r="280" fill="rgba(255, 253, 231, 0.6)" stroke="none"/> <!-- Background zone -->
                    <circle cx="300" cy="300" r="150" fill="rgba(235, 255, 240, 0.6)" stroke="none"/> <!-- Target zone -->
                    
                    <!-- Glucose level circles and labels - centered properly -->
                    <!-- Each label is positioned exactly at the top of its circle -->
                    <circle cx="300" cy="300" r="250" fill="none" stroke="#e8e8f0" stroke-width="1" class="glucose-level-circle"/>
                    <text x="300" y="55" text-anchor="middle" font-size="12" fill="#aaa">160 mg/dL</text>
                    
                    <circle cx="300" cy="300" r="200" fill="none" stroke="#e8e8f0" stroke-width="1" class="glucose-level-circle"/>
                    <text x="300" y="105" text-anchor="middle" font-size="12" fill="#aaa">140 mg/dL</text>
                    
                    <circle cx="300" cy="300" r="150" fill="none" stroke="#e8e8f0" stroke-width="1" class="glucose-level-circle"/>
                    <text x="300" y="155" text-anchor="middle" font-size="12" fill="#aaa">120 mg/dL</text>
                    
                    <circle cx="300" cy="300" r="100" fill="none" stroke="#e8e8f0" stroke-width="1" class="glucose-level-circle"/>
                    <text x="300" y="205" text-anchor="middle" font-size="12" fill="#aaa">100 mg/dL</text>
                    
                    <circle cx="300" cy="300" r="50" fill="none" stroke="#e8e8f0" stroke-width="1" class="glucose-level-circle"/>
                    <text x="300" y="255" text-anchor="middle" font-size="12" fill="#aaa">80 mg/dL</text>
                    
                    <!-- Minute markers - generated with exact 5-degree spacing -->
                    <g id="minute-markers">
                        <!-- Quarter-hour markers -->
                        <!-- 12:15, 12:30, 12:45 -->
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(7.5 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(15 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(22.5 300 300)"/>
                        
                        <!-- 1:15, 1:30, 1:45 -->
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(37.5 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(45 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(52.5 300 300)"/>
                        
                        <!-- 2:15, 2:30, 2:45 -->
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(67.5 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(75 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(82.5 300 300)"/>
                        
                        <!-- Continuing for other hours -->
                        <!-- Only showing quarter hour markers for all hours -->
                        <!-- 3 through 11 quarter-hour marks -->
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(97.5 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(105 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(112.5 300 300)"/>
                        
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(127.5 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(135 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(142.5 300 300)"/>
                        
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(157.5 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(165 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(172.5 300 300)"/>
                        
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(187.5 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(195 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(202.5 300 300)"/>
                        
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(217.5 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(225 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(232.5 300 300)"/>
                        
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(247.5 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(255 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(262.5 300 300)"/>
                        
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(277.5 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(285 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(292.5 300 300)"/>
                        
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(307.5 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(315 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(322.5 300 300)"/>
                        
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(337.5 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(345 300 300)"/>
                        <line x1="300" y1="40" x2="300" y2="60" class="minute-marker" transform="rotate(352.5 300 300)"/>
                    </g>
                    
                    <!-- Hour markers - perfectly spaced at exactly 30 degrees -->
                    <g id="hour-markers">
                        <!-- 12 o'clock -->
                        <line x1="300" y1="30" x2="300" y2="50" class="hour-marker"/>
                        <text x="300" y="20" class="time-label">12:00</text>
                        
                        <!-- 1 o'clock (30 degrees) -->
                        <line x1="435" y1="82.5" x2="422.5" y2="95" class="hour-marker"/>
                        <text x="447.5" y="70" class="time-label">01:00</text>
                        
                        <!-- 2 o'clock (60 degrees) -->
                        <line x1="517.5" y1="182.5" x2="497.5" y2="195" class="hour-marker"/>
                        <text x="530" y="170" class="time-label">02:00</text>
                        
                        <!-- 3 o'clock (90 degrees) -->
                        <line x1="550" y1="300" x2="530" y2="300" class="hour-marker"/>
                        <text x="565" y="305" class="time-label">03:00</text>
                        
                        <!-- 4 o'clock (120 degrees) -->
                        <line x1="517.5" y1="417.5" x2="497.5" y2="405" class="hour-marker"/>
                        <text x="530" y="430" class="time-label">04:00</text>
                        
                        <!-- 5 o'clock (150 degrees) -->
                        <line x1="435" y1="517.5" x2="422.5" y2="505" class="hour-marker"/>
                        <text x="447.5" y="530" class="time-label">05:00</text>
                        
                        <!-- 6 o'clock (180 degrees) -->
                        <line x1="300" y1="550" x2="300" y2="530" class="hour-marker"/>
                        <text x="300" y="565" class="time-label">06:00</text>
                        
                        <!-- 7 o'clock (210 degrees) -->
                        <line x1="165" y1="517.5" x2="177.5" y2="505" class="hour-marker"/>
                        <text x="152.5" y="530" class="time-label">07:00</text>
                        
                        <!-- 8 o'clock (240 degrees) -->
                        <line x1="82.5" y1="417.5" x2="102.5" y2="405" class="hour-marker"/>
                        <text x="70" y="430" class="time-label">08:00</text>
                        
                        <!-- 9 o'clock (270 degrees) -->
                        <line x1="50" y1="300" x2="70" y2="300" class="hour-marker"/>
                        <text x="35" y="305" class="time-label">09:00</text>
                        
                        <!-- 10 o'clock (300 degrees) -->
                        <line x1="82.5" y1="182.5" x2="102.5" y2="195" class="hour-marker"/>
                        <text x="70" y="170" class="time-label">10:00</text>
                        
                        <!-- 11 o'clock (330 degrees) -->
                        <line x1="165" y1="82.5" x2="177.5" y2="95" class="hour-marker"/>
                        <text x="152.5" y="70" class="time-label">11:00</text>
                    </g>
                    
                    <!-- Pre-defined glucose spike at 2:00 PM -->
                    <g id="glucose-event">
                        <!-- Visual representation of the spike -->
                        <path id="glucose-spike" d="M300,300 L517.5,182.5 C500,150 480,160 460,170 C440,180 420,200 400,220 C380,240 350,260 320,280 Z" 
                              fill="rgba(255, 107, 107, 0.2)" stroke="#FF6B6B" stroke-width="2"/>
                        
                        <!-- Marker showing the exact peak time -->
                        <circle cx="517.5" cy="182.5" r="8" fill="#FF6B6B" stroke="#fff" stroke-width="2"/>
                        <text x="530" y="170" text-anchor="middle" font-size="12" fill="#FF6B6B" font-weight="bold">152 mg/dL</text>
                        
                        <!-- Label for the spike -->
                        <text x="450" y="140" text-anchor="middle" font-size="13" fill="#FF6B6B" font-weight="bold">Glucose Spike</text>
                    </g>
                    
                    <!-- Drop target indicator - visual feedback when dragging -->
                    <circle id="drop-target" cx="300" cy="300" r="25" class="drop-target"/>
                    
                    <!-- Time indicator line (initially hidden) -->
                    <line id="time-indicator-line" x1="300" y1="300" x2="300" y2="50" class="time-indicator-line" style="display: none;"/>
                    
                    <!-- Clickable area for the entire clock -->
                    <circle id="clickable-area" cx="300" cy="300" r="270" fill="transparent" />
                    
                    <!-- Clock center decoration -->
                    <circle cx="300" cy="300" r="12" fill="#444" stroke="#fff" stroke-width="2"/>
                    <circle cx="300" cy="300" r="5" fill="#fff"/>
                    
                    <!-- Legend at the bottom with proper positioning -->
                    <g transform="translate(190, 530)">
                        <rect x="0" y="0" width="220" height="70" rx="5" fill="white" fill-opacity="0.9" stroke="#eaeaea"/>
                        <line x1="20" y1="20" x2="50" y2="20" stroke="#FF6B6B" stroke-width="2"/>
                        <text x="60" y="25" font-size="13" fill="#444">Glucose Spike (2:00 PM)</text>
                        <line x1="20" y1="45" x2="50" y2="45" stroke="#0066CC" stroke-width="2" stroke-dasharray="5,3"/>
                        <text x="60" y="50" font-size="13" fill="#444">Drag food here to place</text>
                    </g>
                </svg>
                
                <!-- Time indicator label -->
                <div id="time-indicator-label" class="time-indicator-label" style="display: none;">12:00 PM</div>
            </div>
            
            <!-- Submit analysis button added below the clock -->
            <button id="submit-analysis-btn" class="submit-analysis-btn">Submit Your Analysis</button>
            
            
            
            <div class="results-panel" style="margin: 30px auto;">
                <h2>Analysis Results</h2>
                <div class="score">Score: 85/100</div>
                
                <div class="feedback">
                    <p><strong>Good analysis!</strong> This is very likely what caused Sarah's glucose spike.</p>
                    
                    <p>The <span id="placed-food-name">Apple</span> you placed at <span id="placed-food-time">1:15 PM</span> typically causes glucose to rise within <span id="food-timing">30-45 minutes</span>, which aligns well with the 2:00 PM spike Sarah experienced.</p>
                    
                    <h3>Insights</h3>
                    <p>This food raised Sarah's glucose by approximately <strong>82 mg/dL</strong> at its peak (from baseline of 70 mg/dL to 152 mg/dL). The response lasted about <strong>2.5 hours</strong> before returning to baseline.</p>
                    
                    <p>For Sarah, this food is a <strong id="glycemic-impact">moderate</strong> glycemic impact food. She might consider pairing it with protein or healthy fats to reduce the spike in the future.</p>
                    
                    <div style="background: #f5f7fa; padding: 15px; border-radius: 8px; margin-top: 20px;">
                        <h4 style="margin-top: 0; color: #0066CC;">Recommendations for Sarah:</h4>
                        <ul style="margin-bottom: 0;">
                            <li>Try consuming this food with a source of protein or healthy fat</li>
                            <li>Consider eating smaller portions spread throughout the day</li>
                            <li>A short 10-minute walk after eating can help reduce glucose spikes</li>
                        </ul>
                    </div>
                </div>
                
                <button id="try-another-btn" class="submit-btn">Try Another Analysis</button>
            </div>
        </div>
    </div>
    
    <!-- Notification for prediction set -->
    <div id="prediction-notification" class="prediction-notification">
        Prediction set! Click Submit when ready.
    </div>
    
    <!-- Add JavaScript for navigation functionality -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get references to elements
            const explainerTab = document.getElementById('explainer-tab');
            const gameTab = document.getElementById('game-tab');
            const explainerContent = document.getElementById('explainer-content');
            const gameContent = document.getElementById('game-content');
            const startGameBtn = document.getElementById('start-game-btn');
            const resultsPanel = document.querySelector('.results-panel');
            const tryAnotherBtn = document.getElementById('try-another-btn');
            
            // New drag-and-drop references
            const draggableItems = document.querySelectorAll('.food-option.draggable');
            const clockContainer = document.querySelector('.clock-container');
            const clickableArea = document.getElementById('clickable-area');
            const timeIndicatorLine = document.getElementById('time-indicator-line');
            const timeIndicatorLabel = document.getElementById('time-indicator-label');
            
            // Initially hide the results panel
            if (resultsPanel) {
                resultsPanel.style.display = 'none';
            }
            
            // Make sure proper content is shown on initial page load
            explainerContent.style.display = 'block';
            gameContent.style.display = 'none';
            explainerTab.style.background = '#0066CC';
            gameTab.style.background = '#cccccc';
            
            // Function to switch to explainer view
            function showExplainer() {
                explainerContent.style.display = 'block';
                gameContent.style.display = 'none';
                explainerTab.style.background = '#0066CC';
                gameTab.style.background = '#cccccc';
            }
            
            // Function to switch to game view
            function showGame() {
                explainerContent.style.display = 'none';
                gameContent.style.display = 'block';
                clockContainer.style.display = 'flex';
                if (resultsPanel) resultsPanel.style.display = 'none';
                explainerTab.style.background = '#cccccc';
                gameTab.style.background = '#0066CC';
                
                // Reset the game state
                resetGameState();
            }
            
            // Add event listeners for tab buttons
            explainerTab.addEventListener('click', showExplainer);
            gameTab.addEventListener('click', showGame);
            
            // Add event listener for "Start Prediction Game" button
            if (startGameBtn) {
                startGameBtn.addEventListener('click', showGame);
            }
            
            // Function to reset the game state
            function resetGameState() {
                // Clear any placed food items
                const placedFoods = document.querySelectorAll('.placed-food');
                placedFoods.forEach(item => item.remove());
                
                // Hide the results panel
                if (resultsPanel) {
                    resultsPanel.style.display = 'none';
                }
                
                // Reset drag state for all food options
                draggableItems.forEach(item => {
                    item.classList.remove('dragging');
                    item.style.opacity = '1';
                });
            }
            
            // Helper functions for the clock interactions
            function polarToCartesian(centerX, centerY, radius, angleInDegrees) {
                const angleInRadians = (angleInDegrees - 90) * Math.PI / 180.0;
                return {
                    x: centerX + (radius * Math.cos(angleInRadians)),
                    y: centerY + (radius * Math.sin(angleInRadians))
                };
            }
            
            function calculateAngle(centerX, centerY, pointX, pointY) {
                const deltaX = pointX - centerX;
                const deltaY = pointY - centerY;
                let angle = Math.atan2(deltaY, deltaX) * 180 / Math.PI + 90;
                if (angle < 0) angle += 360;
                return angle;
            }
            
            function calculateDistance(centerX, centerY, pointX, pointY) {
                const deltaX = pointX - centerX;
                const deltaY = pointY - centerY;
                return Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            }
            
            function formatTime(angleInDegrees) {
                // Convert angle to hours (24-hour format)
                // Offset by 12 hours to make 12 o'clock = 12:00 PM
                let hours = Math.floor((angleInDegrees / 360) * 24);
                if (hours < 12) hours += 12;
                if (hours > 23) hours -= 12;
                
                let minutes = Math.floor(((angleInDegrees / 360) * 24 * 60) % 60);
                
                // Format as HH:MM with AM/PM
                const ampm = hours >= 12 ? 'PM' : 'AM';
                hours = hours % 12;
                if (hours === 0) hours = 12;
                
                return `${hours}:${minutes.toString().padStart(2, '0')} ${ampm}`;
            }
            
            // Initialize drag and drop functionality
            draggableItems.forEach(item => {
                item.addEventListener('mousedown', startDrag);
            });
            
            let draggedItem = null;
            
            function startDrag(e) {
                // Prevent default to avoid text selection
                e.preventDefault();
                
                // Set the dragged item
                draggedItem = this;
                draggedItem.classList.add('dragging');
                
                // Set initial position
                const rect = draggedItem.getBoundingClientRect();
                const offsetX = e.clientX - rect.left;
                const offsetY = e.clientY - rect.top;
                
                // Clone the item for dragging
                const clone = draggedItem.cloneNode(true);
                clone.style.position = 'absolute';
                clone.style.left = e.clientX - offsetX + 'px';
                clone.style.top = e.clientY - offsetY + 'px';
                clone.style.zIndex = '1000';
                clone.style.pointerEvents = 'none';
                clone.style.opacity = '0.8';
                clone.id = 'drag-clone';
                document.body.appendChild(clone);
                
                // Show time indicator
                timeIndicatorLine.style.display = 'block';
                timeIndicatorLabel.style.display = 'block';
                
                // Set up move and end events
                document.addEventListener('mousemove', moveDrag);
                document.addEventListener('mouseup', endDrag);
                
                // Set up functions for dragging
                function moveDrag(e) {
                    // Update clone position
                    clone.style.left = e.clientX - offsetX + 'px';
                    clone.style.top = e.clientY - offsetY + 'px';
                    
                    // Check if over the clock
                    const clockRect = clockContainer.getBoundingClientRect();
                    const clockCenterX = clockRect.left + clockRect.width / 2;
                    const clockCenterY = clockRect.top + clockRect.height / 2;
                    
                    const mouseX = e.clientX;
                    const mouseY = e.clientY;
                    
                    // Calculate distance from center
                    const distance = Math.sqrt(
                        Math.pow(mouseX - clockCenterX, 2) + 
                        Math.pow(mouseY - clockCenterY, 2)
                    );
                    
                    // Update time indicator if over the clock area
                    if (distance <= clockRect.width / 2) {
                        // Calculate angle based on mouse position
                        const angle = calculateAngle(
                            clockCenterX, 
                            clockCenterY,
                            mouseX,
                            mouseY
                        );
                        
                        // Update time indicator line position in SVG
                        const endPoint = polarToCartesian(300, 300, 270, angle);
                        timeIndicatorLine.setAttribute('x2', endPoint.x);
                        timeIndicatorLine.setAttribute('y2', endPoint.y);
                        
                        // Update time label
                        const timeStr = formatTime(angle);
                        timeIndicatorLabel.textContent = timeStr;
                        
                        // Position the time label near the edge of the clock
                        const labelPoint = polarToCartesian(300, 300, 290, angle);
                        const svgPoint = document.getElementById('glucose-clock').createSVGPoint();
                        svgPoint.x = labelPoint.x;
                        svgPoint.y = labelPoint.y;
                        
                        const screenPoint = svgPoint.matrixTransform(
                            document.getElementById('glucose-clock').getScreenCTM()
                        );
                        
                        timeIndicatorLabel.style.left = (screenPoint.x - clockRect.left) + 'px';
                        timeIndicatorLabel.style.top = (screenPoint.y - clockRect.top) + 'px';
                        
                        // Show and position the drop target indicator
                        const dropTarget = document.getElementById('drop-target');
                        dropTarget.style.display = 'block';
                        dropTarget.setAttribute('cx', endPoint.x);
                        dropTarget.setAttribute('cy', endPoint.y);
                    } else {
                        // Hide drop target when not over the clock
                        document.getElementById('drop-target').style.display = 'none';
                    }
                }
                
                function endDrag(e) {
                    // Clean up event listeners
                    document.removeEventListener('mousemove', moveDrag);
                    document.removeEventListener('mouseup', endDrag);
                    
                    // Remove the clone
                    const cloneElement = document.getElementById('drag-clone');
                    if (cloneElement) {
                        cloneElement.remove();
                    }
                    
                    // Hide drop target
                    document.getElementById('drop-target').style.display = 'none';
                    
                    // Check if dropped on the clock
                    const clockRect = clockContainer.getBoundingClientRect();
                    const clockCenterX = clockRect.left + clockRect.width / 2;
                    const clockCenterY = clockRect.top + clockRect.height / 2;
                    
                    const distance = Math.sqrt(
                        Math.pow(e.clientX - clockCenterX, 2) + 
                        Math.pow(e.clientY - clockCenterY, 2)
                    );
                    
                    // If dropped on clock, place the food at that time
                    if (distance <= clockRect.width / 2) {
                        // Calculate angle based on drop position
                        const angle = calculateAngle(
                            clockCenterX, 
                            clockCenterY,
                            e.clientX,
                            e.clientY
                        );
                        
                        const timeStr = formatTime(angle);
                        
                        // Calculate position for placed food
                        const foodPoint = polarToCartesian(300, 300, 230, angle);
                        const svgPoint = document.getElementById('glucose-clock').createSVGPoint();
                        svgPoint.x = foodPoint.x;
                        svgPoint.y = foodPoint.y;
                        
                        const screenPoint = svgPoint.matrixTransform(
                            document.getElementById('glucose-clock').getScreenCTM()
                        );
                        
                        // Create placed food element
                        const placedFood = document.createElement('div');
                        placedFood.className = 'placed-food';
                        placedFood.textContent = draggedItem.textContent.split(' ')[0]; // Just the emoji
                        placedFood.dataset.food = draggedItem.dataset.food;
                        placedFood.dataset.time = timeStr;
                        placedFood.dataset.impact = draggedItem.dataset.impact;
                        placedFood.dataset.timing = draggedItem.dataset.timing;
                        
                        placedFood.style.left = (screenPoint.x - clockRect.left) + 'px';
                        placedFood.style.top = (screenPoint.y - clockRect.top) + 'px';
                        
                        clockContainer.appendChild(placedFood);
                        
                        // Show the submit button
                        document.getElementById('submit-analysis-btn').style.display = 'block';
                        
                        // Show notification
                        const notification = document.getElementById('prediction-notification');
                        notification.textContent = 'Food placed! Click Submit Your Analysis when ready.';
                        notification.style.display = 'block';
                    
                    // Hide notification after 3 seconds
                        setTimeout(() => {
                            notification.style.opacity = '0';
                            setTimeout(() => {
                                notification.style.display = 'none';
                                notification.style.opacity = '1';
                        }, 500);
                        }, 3000);
                    }
                    
                    // Reset dragged item
                    if (draggedItem) {
                        draggedItem.classList.remove('dragging');
                        draggedItem = null;
                    }
                    
                    // Hide time indicator
                    timeIndicatorLine.style.display = 'none';
                    timeIndicatorLabel.style.display = 'none';
                }
            }
            
            // Function to show results based on placed food
            function showResults(food, time, impact, timing) {
                if (resultsPanel) {
                    // Update results panel content
                    document.getElementById('placed-food-name').textContent = food.charAt(0).toUpperCase() + food.slice(1);
                    document.getElementById('placed-food-time').textContent = time;
                    document.getElementById('food-timing').textContent = timing;
                    document.getElementById('glycemic-impact').textContent = impact;
                    
                    // Show the results panel
                    resultsPanel.style.display = 'block';
                    
                    // Scroll to results
                    resultsPanel.scrollIntoView({ behavior: 'smooth' });
                }
            }
            
            // Show submit button when food is placed
            function updateSubmitButton() {
                const placedFoods = document.querySelectorAll('.placed-food');
                const submitBtn = document.getElementById('submit-analysis-btn');
                
                if (placedFoods.length > 0) {
                    submitBtn.style.display = 'block';
                } else {
                    submitBtn.style.display = 'none';
                }
            }
            
            // Add event listener for the submit button
            const submitAnalysisBtn = document.getElementById('submit-analysis-btn');
            if (submitAnalysisBtn) {
                submitAnalysisBtn.addEventListener('click', function() {
                    const placedFoods = document.querySelectorAll('.placed-food');
                    if (placedFoods.length > 0) {
                        const placedFood = placedFoods[0];
                        showResults(
                            placedFood.dataset.food,
                            placedFood.dataset.time,
                            placedFood.dataset.impact,
                            placedFood.dataset.timing
                        );
                    }
                });
            }
            
            // Handle "Try Another" button
            if (tryAnotherBtn) {
                tryAnotherBtn.addEventListener('click', function() {
                    resetGameState();
                });
            }
        });
    </script>
    
    <script>
        // Add this to your existing script section
        function selectFoodCategory(category) {
            // Reset all buttons to inactive state
            document.querySelectorAll('.food-toggle-btn').forEach(btn => {
                btn.style.background = '#f5f5f7';
                btn.style.color = '#333';
            });
            
            // Reset all food category cards
            document.querySelectorAll('.food-category').forEach(card => {
                card.style.borderColor = '#f0f0f0';
                card.style.transform = 'scale(1)';
                card.style.boxShadow = '0 2px 8px rgba(0,0,0,0.05)';
            });
            
            // Hide all curves initially
            document.getElementById('high-glycemic-curve').style.display = 'none';
            document.getElementById('medium-glycemic-curve').style.display = 'none';
            document.getElementById('low-glycemic-curve').style.display = 'none';
            
            // Hide all annotations
            document.getElementById('high-glycemic-annotation').style.display = 'none';
            document.getElementById('medium-glycemic-annotation').style.display = 'none';
            
            // Set specific button to active
            if (category !== 'all') {
                document.getElementById(category + '-btn').style.background = '#0066CC';
                document.getElementById(category + '-btn').style.color = 'white';
            } else {
                document.getElementById('view-all-btn').style.background = '#0066CC';
                document.getElementById('view-all-btn').style.color = 'white';
            }
            
            // Highlight the selected food category card
            if (category !== 'all') {
                const selectedCard = document.querySelector(`.${category}-glycemic`);
                selectedCard.style.borderColor = category === 'high' ? '#e53935' : 
                                               category === 'medium' ? '#ff9800' : '#4caf50';
                selectedCard.style.transform = 'scale(1.05)';
                selectedCard.style.boxShadow = '0 5px 15px rgba(0,0,0,0.1)';
            }
            
            // Show curves based on selection
            if (category === 'all') {
                document.getElementById('high-glycemic-curve').style.display = 'block';
                document.getElementById('medium-glycemic-curve').style.display = 'block';
                document.getElementById('low-glycemic-curve').style.display = 'block';
                document.getElementById('high-glycemic-annotation').style.display = 'block';
                document.getElementById('medium-glycemic-annotation').style.display = 'block';
                document.querySelector('.legend').style.display = 'block';
            } else if (category === 'high') {
                document.getElementById('high-glycemic-curve').style.display = 'block';
                document.getElementById('high-glycemic-annotation').style.display = 'block';
                document.querySelector('.legend').style.display = 'none';
            } else if (category === 'medium') {
                document.getElementById('medium-glycemic-curve').style.display = 'block';
                document.getElementById('medium-glycemic-annotation').style.display = 'block';
                document.querySelector('.legend').style.display = 'none';
            } else if (category === 'low') {
                document.getElementById('low-glycemic-curve').style.display = 'block';
                document.querySelector('.legend').style.display = 'none';
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize with all graphs showing
            selectFoodCategory('all');
            
            // Add tooltip functionality for the food comparison graph
            const graphContainer = document.querySelector('.graph-container');
            const tooltipLine = document.getElementById('food-tooltip-line');
            const highGlucosePoint = document.getElementById('high-glucose-point');
            const mediumGlucosePoint = document.getElementById('medium-glucose-point');
            const lowGlucosePoint = document.getElementById('low-glucose-point');
            const foodGlucoseTooltip = document.getElementById('food-glucose-tooltip');
            
            if (graphContainer && tooltipLine && foodGlucoseTooltip) {
                const foodComparisonGraph = document.getElementById('food-comparison-graph');
                
                graphContainer.addEventListener('mousemove', function(event) {
                    const rect = graphContainer.getBoundingClientRect();
                    const svgRect = foodComparisonGraph.getBoundingClientRect();
                    const x = event.clientX - svgRect.left;
                    
                    // Only show tooltip within the graph area (80px - 750px)
                    if (x >= 80 && x <= 750) {
                        // Position the tooltip line
                        tooltipLine.setAttribute('x1', x);
                        tooltipLine.setAttribute('x2', x);
                        tooltipLine.style.display = 'block';
                        
                        // Calculate time based on x position
                        const timePos = (x - 80) / 670; // 0 to 1 position
                        const minutes = Math.round(timePos * 150); // 0 to 150 minutes
                        
                        // Get glucose values for each curve at this x position
                        // These are approximations based on the paths
                        let highGlucose, mediumGlucose, lowGlucose;
                        
                        // Rice (high glycemic)
                        if (x < 190) { // 0-30 min
                            highGlucose = 290 - (x - 80) * 5.7;
                        } else if (x < 300) { // 30-60 min
                            highGlucose = 120 + (x - 190) * 0.18;
                        } else if (x < 410) { // 60-90 min
                            highGlucose = 140 + (x - 300) * 1.09;
                        } else if (x < 520) { // 90-120 min
                            highGlucose = 260 + (x - 410) * 0.27;
                        } else { // 120-150 min
                            highGlucose = 290;
                        }
                        
                        // Apple (medium glycemic)
                        if (x < 190) { // 0-30 min
                            mediumGlucose = 290 - (x - 80) * 3.64;
                        } else if (x < 300) { // 30-60 min
                            mediumGlucose = 180 + (x - 190) * 0.09;
                        } else if (x < 410) { // 60-90 min
                            mediumGlucose = 190 + (x - 300) * 0.73;
                        } else if (x < 520) { // 90-120 min
                            mediumGlucose = 270 + (x - 410) * 0.18;
                        } else { // 120-150 min
                            mediumGlucose = 290;
                        }
                        
                        // Broccoli (low glycemic)
                        if (x < 190) { // 0-30 min
                            lowGlucose = 290 - (x - 80) * 1.09;
                        } else if (x < 300) { // 30-60 min
                            lowGlucose = 260 + (x - 190) * 0.09;
                        } else if (x < 410) { // 60-90 min
                            lowGlucose = 270 + (x - 300) * 0.18;
                        } else { // 90-150 min
                            lowGlucose = 290;
                        }
                        
                        // Position the tooltip points on the glucose curves
                        highGlucosePoint.setAttribute('cx', x);
                        highGlucosePoint.setAttribute('cy', highGlucose);
                        
                        mediumGlucosePoint.setAttribute('cx', x);
                        mediumGlucosePoint.setAttribute('cy', mediumGlucose);
                        
                        lowGlucosePoint.setAttribute('cx', x);
                        lowGlucosePoint.setAttribute('cy', lowGlucose);
                        
                        // Show the points based on which curves are visible
                        highGlucosePoint.style.display = document.getElementById('high-glycemic-curve').style.display !== 'none' ? 'block' : 'none';
                        mediumGlucosePoint.style.display = document.getElementById('medium-glycemic-curve').style.display !== 'none' ? 'block' : 'none';
                        lowGlucosePoint.style.display = document.getElementById('low-glycemic-curve').style.display !== 'none' ? 'block' : 'none';
                        
                        // Convert SVG y-coordinates to glucose values (320 = 70mg/dL, 80 = 160mg/dL)
                        const highGlucoseValue = Math.round(70 + (320 - highGlucose) * (160-70)/(320-80));
                        const mediumGlucoseValue = Math.round(70 + (320 - mediumGlucose) * (160-70)/(320-80));
                        const lowGlucoseValue = Math.round(70 + (320 - lowGlucose) * (160-70)/(320-80));
                        
                        // Update tooltip content based on which curves are visible
                        let tooltipContent = `Time: ${minutes} min<br>`;
                        
                        if (document.getElementById('high-glycemic-curve').style.display !== 'none') {
                            tooltipContent += `<span style="color: #e53935;">White Rice: ${highGlucoseValue} mg/dL</span><br>`;
                        }
                        
                        if (document.getElementById('medium-glycemic-curve').style.display !== 'none') {
                            tooltipContent += `<span style="color: #ff9800;">Apple: ${mediumGlucoseValue} mg/dL</span><br>`;
                        }
                        
                        if (document.getElementById('low-glycemic-curve').style.display !== 'none') {
                            tooltipContent += `<span style="color: #4caf50;">Broccoli: ${lowGlucoseValue} mg/dL</span>`;
                        }
                        
                        foodGlucoseTooltip.innerHTML = tooltipContent;
                        foodGlucoseTooltip.style.display = 'block';
                        
                        // Position tooltip relative to mouse
                        const tooltipX = event.clientX - rect.left + 15;
                        const tooltipY = event.clientY - rect.top - 40;
                        foodGlucoseTooltip.style.left = tooltipX + 'px';
                        foodGlucoseTooltip.style.top = tooltipY + 'px';
                    }
                });
                
                graphContainer.addEventListener('mouseleave', function() {
                    tooltipLine.style.display = 'none';
                    highGlucosePoint.style.display = 'none';
                    mediumGlucosePoint.style.display = 'none';
                    lowGlucosePoint.style.display = 'none';
                    foodGlucoseTooltip.style.display = 'none';
                });
            }
        });
    </script>
    
    <!-- Molecule Animation Script -->
    <script>
        // Three.js setup
        let scene, camera, renderer;
        let glucoseMolecules = [];
        let rotationSpeed = 0.01;
        let glucoseCount = 0;
        
        function init() {
            // Create scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xFFFFFF);
            
            // Create camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;
            
            // Create renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('canvas').appendChild(renderer.domElement);
            
            // Add lights
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(1, 1, 1);
            scene.add(directionalLight);
            
            // Create glucose molecules
            createGlucoseMolecules(15);
            
            // Add event listeners
            window.addEventListener('resize', onWindowResize);
            window.addEventListener('click', onMouseClick);
            
            // Start animation
            animate();
        }
        
        function createGlucoseMolecules(count) {
            for (let i = 0; i < count; i++) {
                // Main glucose ring (hexagon)
                const ringGeometry = new THREE.TorusGeometry(0.3, 0.05, 16, 6);
                const ringMaterial = new THREE.MeshPhongMaterial({ color: 0xFFCC00 });
                const ring = new THREE.Mesh(ringGeometry, ringMaterial);
                
                // Carbon atoms
                const carbonMaterial = new THREE.MeshPhongMaterial({ color: 0x333333 });
                const carbonGeometry = new THREE.SphereGeometry(0.08, 16, 16);
                
                // Oxygen atoms
                const oxygenMaterial = new THREE.MeshPhongMaterial({ color: 0xFF5555 });
                const oxygenGeometry = new THREE.SphereGeometry(0.07, 16, 16);
                
                // Hydrogen atoms
                const hydrogenMaterial = new THREE.MeshPhongMaterial({ color: 0xFFFFFF });
                const hydrogenGeometry = new THREE.SphereGeometry(0.05, 16, 16);
                
                // Create group for the whole molecule
                const molecule = new THREE.Group();
                molecule.add(ring);
                
                // Add atoms at strategic positions around the ring
                for (let j = 0; j < 6; j++) {
                    const angle = (j / 6) * Math.PI * 2;
                    const x = Math.cos(angle) * 0.3;
                    const y = Math.sin(angle) * 0.3;
                    
                    const carbon = new THREE.Mesh(carbonGeometry, carbonMaterial);
                    carbon.position.set(x, y, 0);
                    molecule.add(carbon);
                    
                    // Add oxygen to some carbons
                    if (j % 2 === 0) {
                        const oxygen = new THREE.Mesh(oxygenGeometry, oxygenMaterial);
                        oxygen.position.set(x * 1.3, y * 1.3, 0.1);
                        molecule.add(oxygen);
                    }
                    
                    // Add hydrogens
                    const hydrogen = new THREE.Mesh(hydrogenGeometry, hydrogenMaterial);
                    hydrogen.position.set(x * 1.2, y * 1.2, -0.1);
                    molecule.add(hydrogen);
                }
                
                // Position molecule randomly in space
                molecule.position.x = (Math.random() - 0.5) * 10;
                molecule.position.y = (Math.random() - 0.5) * 10;
                molecule.position.z = (Math.random() - 0.5) * 10;
                
                // Random rotation
                molecule.rotation.x = Math.random() * Math.PI;
                molecule.rotation.y = Math.random() * Math.PI;
                
                // Add velocity for animation
                molecule.userData = {
                    velocityX: (Math.random() - 0.5) * 0.02,
                    velocityY: (Math.random() - 0.5) * 0.02,
                    velocityZ: (Math.random() - 0.5) * 0.02,
                    rotationX: (Math.random() - 0.5) * 0.02,
                    rotationY: (Math.random() - 0.5) * 0.02,
                    rotationZ: (Math.random() - 0.5) * 0.02,
                    clickable: true
                };
                
                scene.add(molecule);
                glucoseMolecules.push(molecule);
            }
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            // Animate each molecule
            glucoseMolecules.forEach(molecule => {
                if (!molecule.userData.clickable) return;
                
                // Apply rotation
                molecule.rotation.x += molecule.userData.rotationX;
                molecule.rotation.y += molecule.userData.rotationY;
                molecule.rotation.z += molecule.userData.rotationZ;
                
                // Apply movement
                molecule.position.x += molecule.userData.velocityX;
                molecule.position.y += molecule.userData.velocityY;
                molecule.position.z += molecule.userData.velocityZ;
                
                // Bounce off invisible boundaries
                if (Math.abs(molecule.position.x) > 5) {
                    molecule.userData.velocityX *= -1;
                }
                if (Math.abs(molecule.position.y) > 5) {
                    molecule.userData.velocityY *= -1;
                }
                if (Math.abs(molecule.position.z) > 5) {
                    molecule.userData.velocityZ *= -1;
                }
            });
            
            renderer.render(scene, camera);
        }
        
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        function onMouseClick(event) {
            // Calculate mouse position in normalized device coordinates
            const mouse = new THREE.Vector2();
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
            
            // Raycasting to detect clicks on molecules
            const raycaster = new THREE.Raycaster();
            raycaster.setFromCamera(mouse, camera);
            
            const intersects = raycaster.intersectObjects(scene.children, true);
            
            if (intersects.length > 0) {
                // Find the parent molecule
                let moleculeClicked = false;
                for (let i = 0; i < glucoseMolecules.length; i++) {
                    const molecule = glucoseMolecules[i];
                    if (!molecule.userData.clickable) continue;
                    
                    if (molecule.children.some(child => {
                        return intersects.some(intersect => intersect.object === child);
                    })) {
                        // "Collect" the molecule
                        collectMolecule(molecule);
                        moleculeClicked = true;
                        break;
                    }
                }
                
                // If no molecule was clicked, create a random one
                if (!moleculeClicked && intersects[0].object.parent === scene) {
                    createGlucoseMolecules(1);
                }
            }
        }
        
        function collectMolecule(molecule) {
            // Animate collection
            molecule.userData.clickable = false;
            
            // Animation - grow and fade out
            let scale = 1.0;
            const fadeInterval = setInterval(() => {
                scale += 0.1;
                molecule.scale.set(scale, scale, scale);
                
                // Make children start fading
                molecule.children.forEach(child => {
                    if (child.material) {
                        if (!child.material.transparent) {
                            child.material = child.material.clone();
                            child.material.transparent = true;
                        }
                        child.material.opacity -= 0.1;
                    }
                });
                
                if (scale >= 2.0) {
                    clearInterval(fadeInterval);
                    scene.remove(molecule);
                    
                    // Remove from array
                    const index = glucoseMolecules.indexOf(molecule);
                    if (index > -1) {
                        glucoseMolecules.splice(index, 1);
                    }
                    
                    // Create a new molecule
                    setTimeout(() => {
                        createGlucoseMolecules(1);
                    }, 500);
                }
            }, 50);
            
            // Update counter
            glucoseCount++;
            document.getElementById('count').textContent = glucoseCount;
        }
        
        // Initialize the animation when document is loaded
        document.addEventListener('DOMContentLoaded', function() {
            init();
        });
    </script>
    
    <!-- Fun facts button and modal -->
    <div class="fun-fact-button" id="fun-fact-button">🍬</div>

    <div class="fun-fact-overlay" id="fun-fact-overlay"></div>

    <div class="fun-fact-modal" id="fun-fact-modal">
        <div class="fun-fact-close" id="fun-fact-close">×</div>
        <h3><span>🍬</span> Sweet Glucose Facts</h3>
        <div class="fun-fact-content" id="fun-fact-content"></div>
        <div class="fun-fact-navigation">
            <div class="fun-fact-counter"><span id="current-fact">1</span>/<span id="total-facts">12</span></div>
            <button class="fun-fact-button-next" id="next-fact-button">Next Fact</button>
        </div>
    </div>

    <!-- Add JavaScript for the fun facts functionality -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Fun facts array
            const glucoseFacts = [
                "Honey is mostly glucose and fructose - that's why it's so sweet!",
                "Glucose is less sweet than fructose but sweeter than lactose. Fructose is 1.7x sweeter than glucose, but glucose is 2x sweeter than lactose (milk sugar).",
                "The word \"glucose\" comes from the Greek word \"gleukos,\" meaning sweet.",
                "Glucose was first isolated from raisins in 1747 by Andreas Marggraf.",
                "Brain's VIP Fuel: Your brain uses 50% of the body's glucose despite being only 2% of its weight, requiring a constant supply to power neurons and cognitive functions.",
                "Sweet Chemistry: Glucose has the formula C₆H₁₂O₆ – six carbon atoms, twelve hydrogen, and six oxygen arranged in a ring structure.",
                "Fiber Shield: Whole fruits slow glucose spikes by up to 30% compared to juices, thanks to their natural fiber.",
                "Red Blood Cell Diet: Red blood cells rely entirely on glucose for energy because they lack mitochondria to burn other fuels.",
                "Metabolic Recycling: Excess glucose becomes fat through lipogenesis – a liver process linked to weight gain.",
                "Ancient Energy: Glucose metabolism pathways evolved 2 billion years ago, making it life's universal energy currency.",
                "Stress Response: Adrenaline triggers emergency glucose release from the liver during \"fight-or-flight\" moments.",
                "Personalized Reactions: Identical meals can cause wildly different spikes in people due to unique gut microbiomes."
            ];
            
            // DOM elements
            const funFactButton = document.getElementById('fun-fact-button');
            const funFactModal = document.getElementById('fun-fact-modal');
            const funFactOverlay = document.getElementById('fun-fact-overlay');
            const funFactContent = document.getElementById('fun-fact-content');
            const funFactClose = document.getElementById('fun-fact-close');
            const nextFactButton = document.getElementById('next-fact-button');
            const currentFactEl = document.getElementById('current-fact');
            const totalFactsEl = document.getElementById('total-facts');
            
            // Current fact index
            let currentFactIndex = 0;
            
            // Update total facts count
            totalFactsEl.textContent = glucoseFacts.length;
            
            // Show fun fact modal
            function showFunFactModal() {
                funFactContent.textContent = glucoseFacts[currentFactIndex];
                currentFactEl.textContent = currentFactIndex + 1;
                funFactModal.classList.add('show');
                funFactOverlay.classList.add('show');
            }
            
            // Hide fun fact modal
            function hideFunFactModal() {
                funFactModal.classList.remove('show');
                funFactOverlay.classList.remove('show');
            }
            
            // Show next fact
            function showNextFact() {
                currentFactIndex = (currentFactIndex + 1) % glucoseFacts.length;
                funFactContent.textContent = glucoseFacts[currentFactIndex];
                currentFactEl.textContent = currentFactIndex + 1;
                
                // Add animation effect
                funFactContent.style.opacity = 0;
                setTimeout(() => {
                    funFactContent.style.opacity = 1;
                }, 300);
            }
            
            // Event listeners
            funFactButton.addEventListener('click', showFunFactModal);
            funFactClose.addEventListener('click', hideFunFactModal);
            funFactOverlay.addEventListener('click', hideFunFactModal);
            nextFactButton.addEventListener('click', showNextFact);
            
            // Periodically highlight the fun fact button
            setInterval(() => {
                funFactButton.classList.add('highlight');
                setTimeout(() => {
                    funFactButton.classList.remove('highlight');
                }, 1000);
            }, 8000);
        });
    </script>
</body>
</html>